## Generated by ansible
*filter
:INPUT {{ iptables_chain_INPUT }} [0:0]
:FORWARD {{ iptables_chain_FORWARD }} [0:0]
:OUTPUT {{ iptables_chain_OUTPUT }} [0:0]
## Begin host-specific rules 
{% for item in iptables_INPUT %}
-A INPUT

  {%- if item.interface is defined %}
 -i {{ item.interface }}
  {%- endif -%}

  {%- if item.sources is defined %}
 -s {{ item.sources | join(",") }}
  {%- endif -%}

  {%- if item.source is defined %}
 -s {{ item.source }}
  {%- endif -%}

  {%- if item.dests is defined %}
 -d {{ item.dests | join(",") }}
  {%- endif -%}

  {%- if item.dest is defined %}
 -d {{ item.dest }}
  {%- endif -%}

  {%- if item.srcrange is defined or item.destrange is defined %}
 -m iprange
    {%- if item.srcrange is defined %}
 --src-range {{ item.srcrange }}
    {%- endif -%}
    {%- if item.destrange is defined %}
 --dst-range {{ item.destrange }}
    {%- endif -%}
  {%- endif -%}

  {%- if item.proto is defined %}
 -p {{ item.proto }}
  {%- elif item.dport is defined %}
 -p tcp
  {%- endif -%}

  {%- if item.state is defined %}
 -m state --state {{ item.state }}
  {%- endif -%}

  {%- if item.match is defined %} -m {{ item.match }}
  {%- elif item.proto is defined and item.dport is defined%} -m {{ item.proto }}
  {%- elif item.dport is defined %} -m tcp
  {%- endif -%}

  {%- if item.dport is defined %}
 --dport {{ item.dport }}
  {%- endif -%}

  {%- if item.dports is defined %}
 -m multiport --dports {{ item.dports }}
  {%- endif -%}

  {%- if item.sport is defined %}
 --sport {{ item.sport }}
  {%- endif -%}

  {%- if item.sports is defined %}
 -m multiport --sports {{ item.sports }}
  {%- endif -%}

  {%- if item.response is defined %}
 -j {{ item.response }}
  {%- else %}
 -j ACCEPT
  {%- endif -%}

  {%- if item.rejectwith is defined %}
 --reject-with {{ item.rejectwith }}
  {%- endif %}

{% endfor %}
## Begin common iptables rules
{% for item in ip6tables_INPUT_footer %}
-A INPUT

  {%- if item.interface is defined %}
 -i {{ item.interface }}
  {%- endif -%}

  {%- if item.sources is defined %}
 -s {% for source in item.sources %}{{source}}{% endfor %}
  {%- endif -%}

  {%- if item.source is defined %}
 -s {{ item.source }}
  {%- endif -%}

  {%- if item.dests is defined %}
 -d {% for dests in item.dests %}{{dest}}{% endfor %}
  {%- endif -%}

  {%- if item.dest is defined %}
 -d {{ item.dest }}
  {%- endif -%}

  {%- if item.srcrange is defined or item.destrange is defined %}
 -m iprange
    {%- if item.srcrange is defined %}
 --src-range {{ item.srcrange }}
    {%- endif -%}
    {%- if item.destrange is defined %}
 --dst-range {{ item.destrange }}
    {%- endif -%}
  {%- endif -%}

  {%- if item.proto is defined %}
 -p {{ item.proto }}
  {%- elif item.dport is defined %}
 -p tcp
  {%- endif -%}

  {%- if item.state is defined %}
 -m state --state {{ item.state }}
  {%- endif -%}

  {%- if item.match is defined %} -m {{ item.match }}
  {%- elif item.proto is defined and item.dport is defined%} -m {{ item.proto }}
  {%- elif item.dport is defined %} -m tcp
  {%- endif -%}

  {%- if item.dport is defined %}
 --dport {{ item.dport }}
  {%- endif -%}

  {%- if item.dports is defined %}
 -m multiport --dports {{ item.dports }}
  {%- endif -%}

  {%- if item.sport is defined %}
 --sport {{ item.sport }}
  {%- endif -%}

  {%- if item.sports is defined %}
 -m multiport --sports {{ item.sports }}
  {%- endif -%}

  {%- if item.response is defined %}
 -j {{ item.response }}
  {%- else %}
 -j ACCEPT
  {%- endif -%}

  {%- if item.rejectwith is defined %}
 --reject-with {{ item.rejectwith }}
  {%- endif %}

{% endfor %}
{%- for item in ip6tables_FORWARD %}
-A FORWARD

  {%- if item.interface is defined %}
 -i {{ item.interface }}
  {%- endif -%}

  {%- if item.sources is defined %}
 -s {% for source in item.sources %}{{source}}{% endfor %}
  {%- endif -%}

  {%- if item.source is defined %}
 -s {{ item.source }}
  {%- endif -%}

  {%- if item.dests is defined %}
 -d {% for dests in item.dests %}{{dest}}{% endfor %}
  {%- endif -%}

  {%- if item.dest is defined %}
 -d {{ item.dest }}
  {%- endif -%}

  {%- if item.srcrange is defined or item.destrange is defined %}
 -m iprange
    {%- if item.srcrange is defined %}
 --src-range {{ item.srcrange }}
    {%- endif -%}
    {%- if item.destrange is defined %}
 --dst-range {{ item.destrange }}
    {%- endif -%}
  {%- endif -%}

  {%- if item.proto is defined %}
 -p {{ item.proto }}
  {%- elif item.dport is defined %}
 -p tcp
  {%- endif -%}

  {%- if item.state is defined %}
 -m state --state {{ item.state }}
  {%- endif -%}

  {%- if item.match is defined %} -m {{ item.match }}
  {%- elif item.proto is defined and item.dport is defined%} -m {{ item.proto }}
  {%- elif item.dport is defined %} -m tcp
  {%- endif -%}

  {%- if item.dport is defined %}
 --dport {{ item.dport }}
  {%- endif -%}

  {%- if item.dports is defined %}
 -m multiport --dports {{ item.dports }}
  {%- endif -%}

  {%- if item.sport is defined %}
 --sport {{ item.sport }}
  {%- endif -%}

  {%- if item.sports is defined %}
 -m multiport --sports {{ item.sports }}
  {%- endif -%}

  {%- if item.response is defined %}
 -j {{ item.response }}
  {%- else %}
 -j ACCEPT
  {%- endif -%}

  {%- if item.rejectwith is defined %}
 --reject-with {{ item.rejectwith }}
  {%- endif %}

{% endfor %}
{%- for item in iptables_OUTPUT %}
-A OUTPUT

  {%- if item.interface is defined %}
 -i {{ item.interface }}
  {%- endif -%}

  {%- if item.sources is defined %}
 -s {% for source in item.sources %}{{source}}{% endfor %}
  {%- endif -%}

  {%- if item.source is defined %}
 -s {{ item.source }}
  {%- endif -%}

  {%- if item.dests is defined %}
 -d {% for dests in item.dests %}{{dest}}{% endfor %}
  {%- endif -%}

  {%- if item.dest is defined %}
 -d {{ item.dest }}
  {%- endif -%}

  {%- if item.srcrange is defined or item.destrange is defined %}
 -m iprange
    {%- if item.srcrange is defined %}
 --src-range {{ item.srcrange }}
    {%- endif -%}
    {%- if item.destrange is defined %}
 --dst-range {{ item.destrange }}
    {%- endif -%}
  {%- endif -%}

  {%- if item.proto is defined %}
 -p {{ item.proto }}
  {%- elif item.dport is defined %}
 -p tcp
  {%- endif -%}

  {%- if item.state is defined %}
 -m state --state {{ item.state }}
  {%- endif -%}

  {%- if item.match is defined %} -m {{ item.match }}
  {%- elif item.proto is defined and item.dport is defined%} -m {{ item.proto }}
  {%- elif item.dport is defined %} -m tcp
  {%- endif -%}

  {%- if item.dport is defined %}
 --dport {{ item.dport }}
  {%- endif -%}

  {%- if item.dports is defined %}
 -m multiport --dports {{ item.dports }}
  {%- endif -%}

  {%- if item.sport is defined %}
 --sport {{ item.sport }}
  {%- endif -%}

  {%- if item.sports is defined %}
 -m multiport --sports {{ item.sports }}
  {%- endif -%}

  {%- if item.response is defined %}
 -j {{ item.response }}
  {%- else %}
 -j ACCEPT
  {%- endif -%}

  {%- if item.rejectwith is defined %}
 --reject-with {{ item.rejectwith }}
  {%- endif %}

{% endfor %}
COMMIT
